
do
(
	def(":color" function(//#r #g #b
		set_copy(".col" map)
		push_copy(get(".col") 
			"r" get("#r")
			"g" get("#g")
			"b" get("#b")
		)
		return_copy(get(".col"))
	))
	
	def(":cat" function(//#name #age #color
		set_copy(".cat" map)
		push_copy(get(".cat")
			"name" get("#name")
			"age" get("#age")
			"color" get("#color")
			"make_sound" func_ref(print("mjau!\n"))
		)
		return_copy(get(".cat"))
	))
	
	def(":dog" function(//#name #age #color
		set_copy(".dog" map)
		push_copy(get(".dog")
			"name" get("#name")
			"age" get("#age")
			"color" get("#color")
			"make_sound" func_ref(print("woof!\n"))
		)
		return_copy(get(".dog"))
	))
	
	set_copy("pets" list)
	push_ref(get("pets")
		get(":cat" 
			"#name" "Tolo" 
			"#age" 10 
			"#color" get(":color" 
				"#r" 0.4 
				"#g" 0.34 
				"#b" 0.5))
		get(":cat"
			"#name" "Bippe"
			"#age" 7
			"#color" "gray tiger")
		get(":dog" 
			"#name" "Stella" 
			"#age" 14 
			"#color" get(":color" 
				"#r" 0.2 
				"#g" 0.2 
				"#b" 0.1))
	)
	
	set_copy("i" 0)
	while(less(get("i") count(get("pets"))) do(
		set_ref("pet" get_elem(get("pets") get("i")))
		print(get("pet") ":\n")
		eval(get_elem(get("pet") "make_sound"))
		set_copy("i" add(get("i") 1))
	))
)